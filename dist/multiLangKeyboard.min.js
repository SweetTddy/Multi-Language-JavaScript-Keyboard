var multiLangKeyboard=new function(){function n(n,t){var i=n[t]!==undefined;return i||console.error("multiLangKeyboard: keyboard '",t,"' not found"),i}function t(n){var t=document.querySelector(n)!==null;return t||console.error("multiLangKeyboard: keyboard selector '",n,"' not found"),t}function i(n){var t=document.querySelector(n)!==null;return t||console.error("multiLangKeyboard: keyboard input selector '",n,"' not found"),t}this.version="0.1.0";this.keyboard=null;this.keyboards={};this.options={wrapClass:"multi-lang-keyboard-wrap",localize:{backspace:"Backspace",enter:"Enter",space:"Space",shift:"Shift",alt:"Alt"}};this.addKeyboard=function(n,t,i){this.keyboards[t]={name:n,layout:i}};this.availableKeyboards=function(){var n=[];for(var t in this.keyboards)n.push({code:t,name:this.keyboards[t].name});return n};this.render=function(r,u,f){if(n(this.keyboards,r)&&t(u)&&i(f)){var e=document.querySelector(u),o=document.querySelector(f);e.innerHTML=this.renderHTML(r);this.addEvents(e.querySelector("."+this.options.wrapClass),o)}};this.renderHTML=function(n){var c=this.keyboards[n],r=document.createElement("div"),u,f,t,i,e,o,s,h;for(r.setAttribute("class",this.options.wrapClass),r.setAttribute("data-alt","false"),r.setAttribute("data-events","false"),r.setAttribute("data-shift","false"),r.setAttribute("data-keyboard-name",c.name),r.setAttribute("data-keyboard-code",n),u=0;u<c.layout.length;u++){var l=c.layout[u],a=document.createElement("table"),v=document.createElement("tr");for(f=0;f<l.length;f++)t=l[f],i=document.createElement("td"),t.special==="spacer"?i.setAttribute("class","spacer"):t.special!==null?(i.setAttribute("class","special-key"),i.setAttribute("data-action",t.special),i.innerText=this.options.localize[t.special]):(i.setAttribute("class","key"),t.title&&i.setAttribute("title",t.title),t.default&&i.setAttribute("data-default",t.default),t.shift&&i.setAttribute("data-shift",t.shift),t.alt&&i.setAttribute("data-alt",t.alt),t.alt_shift&&i.setAttribute("data-alt-shift",t.alt_shift),t.default&&(e=document.createElement("span"),e.innerText=t.default,e.setAttribute("class","default"),i.appendChild(e)),t.shift&&(o=document.createElement("span"),o.innerText=t.shift,o.setAttribute("class","shift"),i.appendChild(o)),t.alt_shift&&(s=document.createElement("span"),s.innerText=t.alt_shift,s.setAttribute("class","alt-shift"),i.appendChild(s)),t.alt&&(h=document.createElement("span"),h.innerText=t.alt,h.setAttribute("class","alt"),i.appendChild(h))),v.appendChild(i);a.appendChild(v);r.appendChild(a)}return r.outerHTML};this.addEvents=function(n,t){function s(i,e){var s=e.getAttribute("data-action"),o;switch(s){case"backspace":h(t);break;case"enter":f(t,"\r");break;case"shift":n.setAttribute("data-shift",r()?"false":"true");break;case"alt":n.setAttribute("data-alt",u()?"false":"true");break;case"space":f(t," ");break;case null:o=null;u()&&r()?e.getAttribute("data-alt-shift")!==""&&(o=e.getAttribute("data-alt-shift")):u()?e.getAttribute("data-alt")!==""&&(o=e.getAttribute("data-alt")):r()?e.getAttribute("data-shift")!==""&&(o=e.getAttribute("data-shift")):o=e.getAttribute("data-default");o!==null&&f(t,o);n.setAttribute("data-shift","false");n.setAttribute("data-alt","false")}}function r(){return n.getAttribute("data-shift")==="true"}function u(){return n.getAttribute("data-alt")==="true"}function f(n,t){var i=o(n);n.value=n.value.slice(0,i[0])+t+n.value.slice(i[1],n.value.length);i[0]===i[1]?n.setSelectionRange(i[1]+t.length,i[1]+t.length):n.setSelectionRange(i[0]+t.length,i[0]+t.length)}function h(n){var t=o(n);t[0]===t[1]&&t[0]>0&&(n.value=n.value.slice(0,t[0]-1)+n.value.slice(t[0],n.value.length),n.setSelectionRange(t[0]-1,t[0]-1));t[0]!==t[1]&&(n.value=n.value.slice(0,t[0])+n.value.slice(t[1],n.value.length),n.setSelectionRange(t[0],t[0]))}function o(n){return n.focus(),[n.selectionStart,n.selectionEnd]}for(var e=n.querySelectorAll(".key, .special-key"),i=0;i<e.length;i++)e[i].onclick=function(n){s(n,this)}}}
